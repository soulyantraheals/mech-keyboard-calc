<!doctype html>
<html lang="en">

<script >
    // PASTE THE LOGIC HERE
    // Right after the opening <script> tag

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('status') === 'success') {
        localStorage.setItem('isPremiumUser', 'true');
        window.history.replaceState({}, document.title, window.location.pathname);
    }

    let hasPaid = localStorage.getItem('isPremiumUser') === 'true';

    // ... your other functions like selectTheme() and applyTheme()
  </script>

</body>
</html>
<head>
   <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Rajdhani&display=swap" rel="stylesheet">

    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mechanical Calculator Pro</title>
    <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #1a1a2e; --bg-secondary: #0f0f1a;
            --key-text: #00ffff; --key-light: #2d2d4a; --key-dark: #1a1a2e;
            --accent: #00ffff;
        }
        body { background-color: #050505; font-family: 'Rajdhani', sans-serif; color: white; overflow: hidden; }
        
        /* FIX: Added overflow-hidden and break-all to keep numbers inside */
        .display { 
            background: #0a0a15; 
            font-family: 'Orbitron', sans-serif; 
            border: 2px solid #2a2a4a;
            word-break: break-all;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            min-height: 100px;
        }

        .calculator-body {
            background: linear-gradient(145deg, var(--bg-primary), var(--bg-secondary));
            border: 3px solid #2a2a4a;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.15);
        }

        .key {
            background: linear-gradient(145deg, var(--key-light), var(--key-dark));
            border: 1px solid #3a3a5a;
            box-shadow: 0 4px 0 #0a0a15;
            color: var(--key-text);
            text-shadow: 0 0 8px var(--key-text);
            transition: all 0.05s ease;
        }
        .key:active { transform: translateY(2px); box-shadow: 0 2px 0 #0a0a15; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 50; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="w-full max-w-sm p-4">
        <div class="calculator-body rounded-3xl p-6">
            <div class="flex justify-between items-center mb-4">
                <span class="text-[10px] text-cyan-500 font-bold tracking-[0.2em]">MECH-CALC PRO</span>
                <div class="flex gap-2">
                    <button id="muteBtn" onclick="toggleMute()" class="bg-gray-800 text-white text-[10px] px-2 py-1 rounded-full border border-gray-600">ðŸ”Š ON</button>
                    <button onclick="toggleModal()" class="bg-cyan-950 text-cyan-400 text-[10px] px-3 py-1 rounded-full border border-cyan-700">ðŸŽ¨ THEMES</button>
                </div>
            </div>

            <div class="display rounded-2xl p-4 mb-6 text-right overflow-hidden">
                <div id="expr" class="text-gray-600 text-xs h-4 mb-1"></div>
                <div id="res" class="text-cyan-400 text-2xl font-bold leading-tight">0</div>
            </div>

            <div class="grid grid-cols-4 gap-3" id="key-grid"></div>
        </div>
    </div>

    <div id="themeModal" class="modal p-4">
        <div class="bg-[#0f0f1a] border-2 border-cyan-900 rounded-3xl w-full max-w-xs p-6 text-center">
            <h2 class="text-xl font-bold text-cyan-400 mb-6 font-['Orbitron']">THEMES</h2>
            <button onclick="applyTheme('dark')" class="w-full mb-3 p-3 bg-gray-800 rounded-xl border border-gray-600 hover:border-cyan-400">Dark Mode (Free)</button>
            <button onclick="checkPremium()" class="w-full p-3 bg-white text-black font-bold rounded-xl border border-gray-300 hover:bg-gray-200">White Hybrid (Premium)</button>
            <button onclick="toggleModal()" class="mt-6 text-gray-500 text-sm hover:text-white">Close</button>
        </div>
    </div>

    <script>
        // --- ðŸŽ§ UPDATED SOUND ENGINE ---
        let isMuted = false;
        // Using a reliable typewriter "clack"
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const clickSound = new Audio('https://www.soundjay.com/communication/typewriter-key-1.mp3');

        function playMechSound() {
            if (!isMuted) {
                // Important: Reset sound every click so it doesn't lag
                const soundClone = clickSound.cloneNode();
                soundClone.volume = 0.4;
                soundClone.play().catch(e => console.log("Click a button first to enable audio"));
            }
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteBtn').innerText = isMuted ? "ðŸ”‡ OFF" : "ðŸ”Š ON";
            document.getElementById('muteBtn').style.backgroundColor = isMuted ? "#7f1d1d" : "#1f2937";
        }

        // --- ðŸ”¢ CALCULATOR LOGIC ---
        const keys = ['C', 'Ã·', 'Ã—', 'âŒ«', '7', '8', '9', '-', '4', '5', '6', '+', '1', '2', '3', '=', '0', '.'];
        let expression = "";
        const resDiv = document.getElementById('res');
        const exprDiv = document.getElementById('expr');

        const grid = document.getElementById('key-grid');
        keys.forEach(k => {
            const btn = document.createElement('button');
            btn.className = `key rounded-xl h-14 font-bold text-lg ${k === '=' ? 'bg-cyan-500 text-black' : ''} ${k === '0' ? 'col-span-2' : ''}`;
            btn.innerText = k;
            btn.onclick = () => {
                playMechSound();
                handleInput(k);
            };
            grid.appendChild(btn);
        });

        function handleInput(k) {
            if (k === 'C') { expression = ""; resDiv.innerText = "0"; exprDiv.innerText = ""; }
            else if (k === 'âŒ«') { expression = expression.slice(0, -1); resDiv.innerText = expression || "0"; }
            else if (k === '=') {
                try {
                    let result = eval(expression.replace('Ã—', '*').replace('Ã·', '/'));
                    exprDiv.innerText = expression;
                    resDiv.innerText = result;
                    expression = result.toString();
                } catch { resDiv.innerText = "Error"; expression = ""; }
            } else {
                expression += k;
                resDiv.innerText = expression;
            }
            
            // AUTO-RESIZE FONT: Shrinks text if it gets too long to prevent spill
            if (resDiv.innerText.length > 12) {
                resDiv.style.fontSize = "1.2rem";
            } else {
                resDiv.style.fontSize = "1.875rem";
            }
        }

        // --- ðŸŽ¨ THEME LOGIC ---
        function toggleModal() { document.getElementById('themeModal').classList.toggle('active'); }
        
        function applyTheme(t) {
            if (t === 'dark') {
                document.documentElement.style.setProperty('--bg-primary', '#1a1a2e');
                document.documentElement.style.setProperty('--key-text', '#00ffff');
            } else {
                document.documentElement.style.setProperty('--bg-primary', '#ffffff');
                document.documentElement.style.setProperty('--key-text', '#333');
                document.documentElement.style.setProperty('--key-light', '#f3f4f6');
                document.documentElement.style.setProperty('--key-dark', '#d1d5db');
            }
            toggleModal();
        }

        function checkPremium() {
            if (localStorage.getItem('isPremiumUser') === 'true') {
                applyTheme('white');
            } else {
                alert("Please pay $1 to unlock Premium Themes!");
                window.open("https://rzp.io/rzp/kd2NGSTq", "_blank");
            }
        }
    </script>
</body>
</html>